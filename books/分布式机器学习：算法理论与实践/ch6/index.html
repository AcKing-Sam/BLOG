
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ch5/">
      
      
        <link rel="next" href="../ch7/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>ch6 - AcKing's Ideas</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AcKing&#39;s Ideas" class="md-header__button md-logo" aria-label="AcKing's Ideas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AcKing's Ideas
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ch6
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_3">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../courses/open_mlsys/ch2/" class="md-tabs__link">
        courses
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../blogs/vector_db/something%20about%20vector%20db/" class="md-tabs__link">
        blogs
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/ch1/" class="md-tabs__link md-tabs__link--active">
        books
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AcKing&#39;s Ideas" class="md-nav__button md-logo" aria-label="AcKing's Ideas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AcKing's Ideas
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          courses
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          courses
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
          open mlsys
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_1">
          <span class="md-nav__icon md-icon"></span>
          open mlsys
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch2/" class="md-nav__link">
        chapter 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch3/" class="md-nav__link">
        chapter 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch4/" class="md-nav__link">
        chapter 4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch6/" class="md-nav__link">
        chapter 6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch7/" class="md-nav__link">
        chapter 7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch8/" class="md-nav__link">
        chapter 8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch9/" class="md-nav__link">
        chapter 9
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch10/" class="md-nav__link">
        chapter 10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/open_mlsys/ch11/" class="md-nav__link">
        chapter 11
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
          CSCI_5120
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          CSCI_5120
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/CSCI_5120/Apriori/" class="md-nav__link">
        Apriori
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/CSCI_5120/fp_tree/" class="md-nav__link">
        FP-tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/CSCI_5120/CLIQUE/" class="md-nav__link">
        CLIQUE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/CSCI_5120/vp_tree/" class="md-nav__link">
        VP-tree
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_3" >
      
      
      
        <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
          动手学深度学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          动手学深度学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/ch1-%E5%BC%95%E8%A8%80/" class="md-nav__link">
        引言
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          blogs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          blogs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          vector_db
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          vector_db
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/vector_db/something%20about%20vector%20db/" class="md-nav__link">
        something about vector db
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/storage/parquet/" class="md-nav__link">
        parquet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/storage/data%20lake/" class="md-nav__link">
        data lake
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/storage/Optimization%20for%20ZMQ/" class="md-nav__link">
        optimization for ZMQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/linux/ld%E5%92%8Cld.so%E7%9A%84%E5%8C%BA%E5%88%AB/" class="md-nav__link">
        ld和ld.so的区别
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/linux/futex%E9%94%81%E5%8E%9F%E7%90%86%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/" class="md-nav__link">
        futex锁原理及其应用
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          mlsys
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          mlsys
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/mlsys/mlsys_summary/" class="md-nav__link">
        综述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blogs/mlsys/%E5%88%86%E5%B8%83%E5%BC%8F%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        D-DNN-SYS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          books
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          books
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          程序员的自我修养
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          程序员的自我修养
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/ch1/" class="md-nav__link">
        ch1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          分布式机器学习：算法理论与实践
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          分布式机器学习：算法理论与实践
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ch1/" class="md-nav__link">
        ch1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ch3/" class="md-nav__link">
        ch3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ch4/" class="md-nav__link">
        ch4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ch5/" class="md-nav__link">
        ch5
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ch6
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ch6
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    计算并行模式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    数据并行模式
  </a>
  
    <nav class="md-nav" aria-label="数据并行模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    数据样本划分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    数据维度划分
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    模型并行模式
  </a>
  
    <nav class="md-nav" aria-label="模型并行模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    线性模型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    神经网络
  </a>
  
    <nav class="md-nav" aria-label="神经网络">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    横向按层划分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    纵向跨层划分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    混合划分
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    模型随机并行
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ch7/" class="md-nav__link">
        ch7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ch8/" class="md-nav__link">
        ch8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ch9/" class="md-nav__link">
        ch9
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    计算并行模式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    数据并行模式
  </a>
  
    <nav class="md-nav" aria-label="数据并行模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    数据样本划分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    数据维度划分
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    模型并行模式
  </a>
  
    <nav class="md-nav" aria-label="模型并行模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    线性模型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    神经网络
  </a>
  
    <nav class="md-nav" aria-label="神经网络">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    横向按层划分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    纵向跨层划分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    混合划分
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    模型随机并行
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>ch6</h1>

<h2 id="_1">简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li>计算并行模式
   如果所有的工作节点共享一块公共内存(例如单机多线程环境)，并且数据和模型能全部存储于这块共享内存中，那么我们就不需要对数据和模型进行划分。这时，每个工作节点对数据有完全的访问权限，可以并行地执行相应的优化算法。</li>
</ol>
<p>在这种并行模式下，当使用随机优化算法时，我们对数据的生成方式通常有两种不同的假定:“在线数据生成”和“离线数据生成”。在线数据生成假定每个工作节点访问到的数据是按照真实分布即时生成出来的;离线数据生成则假定按照真实分布事先生成了一个离线数据集，之后每个工作节点再依据均匀分布从该离线数据集中重复采样得到训练所需的数据。一般来说，在线数据生成的假设对理解计算并行算法的理论性质有帮助，不过，实际中训练数据一般是事先离线生成的。</p>
<ol>
<li>数据并行模式</li>
</ol>
<p>如果工作节点没有共享的公共内存，只有容量受限的本地内存，而训练数据的规模很大，无法存储于本地内存，我们就需要对数据集进行划分，分配到各个工作节点上然后工作节点依据各自分配的局部数据对模型进行训练。</p>
<p>如果训练数据的样本量比较大，需要对数据按照样本进行划分，我们称之为数据样本划分。经典的数据样本划分方法有如下两种：</p>
<p>第一种是基于“随机采样”的方法。我们把原始训练数据集作为采样的数据源通过有放回的方式进行随机采样，然后按照每个工作节点的内存容量为其分配相应数目的训练样本。随机采样方法可以保证每台机器上的局部训练数据与原始训练数据是独立同分布的，因此在训练的效果上有理论保证。但随机采样也有它的弊端:首先，因为训练数据较大，实现全局采样的计算复杂度比较高;其次，如果随机采样的次数小于数据样本的数目，可能有些训练样本会一直未被选出，导致辛苦标注的训练样本并没有得到充分的利用。</p>
<p>第二种是基于“置乱切分”的方法。该方法将训练数据进行随机置乱，然后按照工作节点的个数将打乱后的数据顺序划分成相应的小份，随后将这些小份数据分配到各个工作节点上。每个工作节点在进行模型训练的过程中，只利用分配给自己的局部数据，<strong>并且会定期地(如每完成一个训练周期之后)将局部数据再打乱一次。到一定阶段(如完成多个训练周期之后)，还可能再重新进行全局的数据打乱和重新分配。</strong>这样做的主要的目的是，让各个工作节点上的训练样本更加独立并具有更加一致的分布，以满足机器学习算法中训练数据要独立同分布的假设。置乱切分方法相比于随机采样方法，虽然数据的分布与原始数据分布略有偏差，但是其计算复杂度比全局随机采样要小很多，而且置乱切分能保留每一个样本，直观上对样本的利用更充分。</p>
<p>如果训练数据的维度比较高，还可以对数据按照维度进行划分，我们称之为“数据维度划分”。相比于数据样本划分，数据维度划分与模型性质和优化算法的耦合度较高。一般地，如果优化目标线性可分(比如逻辑回归]、支持向量机、线性回归等线性任务)，且计算某个维度的偏导数可以通过较小的代价得到，则可以使用基于数据维度划分的数据并行，高效地对模型进行更新。</p>
<ol>
<li>模型并行模式</li>
</ol>
<p>如果机器学习模型的规模比较大，无法存储于本地内存，则需要对模型进行划分。
   对于线性模型，我们可以将对应于不同数据维度的模型参数划分到不同的工作节点上。由于模型是线性可分的，工作节点能够只依赖于某个全局变量和对应维度的数据信息，独立地更新自己所负责的参数，而不需要依赖于其他工作节点。因而，<strong>线性模型的模型并行比较容易实现，并且一般与按数据维度划分的数据并行配合使用。</strong></p>
<p>对于高度非线性的神经网络，各个工作节点不能相对独立地完成对自己负责的参数的训练和更新，必须依赖与其他工作节点的协作。那么，如何利用神经网络的结构特点和优化过程，以尽量小的通信代价实现对神经网络的模型并行呢?常用的针对神经网络的模型并行方法有：横向按层划分、纵向跨层划分和模型随机划分。</p>
<p>当横向按层划分时，我们将神经网络每两层间的连边参数、激活函数值和误差传播值存储于一个工作节点。当前传过程需要前一层的激活函数值时，向对应的工作节点发出请求并接收相应的数据，然后再利用这些数据计算本层的前向激活函数值;当后传过程需要后一层的误差传播值时，同样，向对应的工作节点发出请求并接收相应的数据然后利用这些数据计算本层的后向误差传播值。横向按层划分时，各子模型之间的接口清晰，实现简单。<strong>但是，横向按层划分方法受到层数的限制，并行度可能不够理想：如果单层的模型参数已经超出了一个工作节点的容限，这时横向按层划分将会由于并行度太低而变得无能为力</strong>。如果模型层数多于单层模型的参数个数，横向按层划分又会由于并行度太高而使得通信代价高昂。</p>
<p>当纵向跨层划分时，我们将每一层的参数均等地划分成若干份，每一个工作节点存储由所有层的一部分参数构成的子网络模型。<strong>在前传和后传过程中，如果需要子模型以外的激活函数值和误差传播值，则向对应的工作节点发出请求并接收相应的数据。</strong>采用跨层的纵向划分，可以将模型划分成多份(比如多到与每层节点数相同)，从而实现较高的并行程度。但是，<strong>随着划分份数的增加，各子模型之间的依赖关系会更加复杂，实现起来难度更大，并且通信代价也相应地增加</strong>。</p>
<p>近几年，人们发现神经网络具有一定的冗余性，即给定一个神经网络，往往存在一个规模更小的网络可以达到与其类似的函数拟合效果。我们把这个小网络称为骨架网络。可以利用骨架网络实现对神经网络的更高效的模型并行。具体做法是，首先把骨架网络存储于每个工作节点，除此之外，各个工作节点互相通信的时候，还会随机传输一些属于非骨架网络的神经元参数，从而起到探索原网络全局拓扑结构的作用。骨架网络的选择可以是周期性更新的，对全局拓扑结构的探索也是动态、随机的。这样可以显著减小神经网络模型并行的通信代价，而且实验表明它有很好的训练效果!0。我们称这种针对神经网络的模型并行方法为“模型随机划分”</p>
<p><img alt="image-20230823185353240" src="https://blog-img-acking.oss-cn-beijing.aliyuncs.com/img/202308231853324.png" /></p>
<h2 id="_2">计算并行模式<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>假设系统中的工作节点拥有共享内存(比如单机多线程环境)，可以存储下数据和模型，并且每个工作节点对数据有完全的访问权限，对模型有读写权限。那么，在此类系统中实现分布式机器学习算法，对数据和模型不需要特殊处理，<strong>只需要把注意力集中在如何并行地执行相应的优化算法上。</strong></p>
<p>如前所述，我们将会以同步的随机梯度下降法(SGD)为例对计算并行模式进行介绍。假设有K个工作节点，共同协作，运行随机梯度下降算法。不失一般性，如无特殊说明，本章及接下来各章都假定工作节点执行单样本随机算法。在每次迭代的开始，每个工作节点都从共享内存读取当前的模型参数和一个样本，然后在本工作节点上计算当前模型针对所读取到的样本的梯度，最后将计算好的梯度乘以步长加到当前模型上。等所有工作节点都完成这样一系列操作之后，下一次迭代开始。
由此可见，(同步)并行执行的随机梯度下降法每次依据K个(来自不同工作节点的)样本上的梯度来更新模型，其实等价于批量大小为K的小批量随机梯度下降法。如果每个节点本身已经在执行批量大小为b的小批量随机梯度下降法，则同步并行的效果相当于批量大小为bK的小批量随机梯度下降法。</p>
<p><img src="https://blog-img-acking.oss-cn-beijing.aliyuncs.com/img/202308231857751.png" alt="image-20230823185727696" style="zoom:67%;" /></p>
<blockquote>
<p>有一个问题值得我们注意，这些工作节点是以什么样的方式获取数据的呢?共享数据又是怎么生成的呢?这对分析并行优化算法的收敛速率、理解数据在随机梯度下降法的并行实现中所起的作用非常有帮助。</p>
<p>通常，我们假定数据有两种生成方式:在线生成和离线生成。如果假定数据是在线生成的，那么工作节点读取的数据是即时地从真实的数据分布里生成的。数据的生成过程在优化算法结束的时候才停止。如果假定数据是离线生成的，那么共享内存中的训练数据是在算法开始执行前从真实的数据分布里生成的。当算法开始执行之后，不再生成新的数据，工作节点需要样本时，通过随机采样使用这些数据中的某一个。</p>
</blockquote>
<p>在这两种数据生成方式下，并行随机梯度下降法收敛性的衡量准则是不同的。在线生成模式下，我们关注算法的后悔度(regret)，而在离线数据生成的方式下，我们则沿用第4章和第5章中使用的收敛性准则(为了与后悔度进行区分，我们称之为次优性准则)。</p>
<h2 id="_3">数据并行模式<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>如果工作节点有本地内存，但容量不足以存放下所有数据，此时，需要对数据进行划分，然后分配到各个工作节点。之后，各个工作节点使用本地数据对模型按照某种优化方法进行更新。这一并行模式被称为数据并行。</p>
<p>相比数据不需要划分的计算并行模式，训练数据分布在不同的工作节点上，所以数据并行模式下的算法属于分布式算法。
数据样本划分和数据维度划分是两种常见的数据划分方法。其中，对于样本划分方法，又有随机采样和(全局/局部) 置乱切分等方法。总体来说，进行数据划分时要考虑以下两个因素：</p>
<p>一是数据量和数据维度与本地内存的相对大小，以此判断数据按照样本划分和维度划分后能否合适地存储到本地内存。</p>
<p>二是优化方法的特点。通常，<strong>样本划分更适用于随机抽取样本的优化方法</strong>(比如随机梯度下降法)，<strong>维度划分更适用于随机抽取维度</strong>的优化方法(比如随机坐标下降法)。</p>
<h3 id="_4">数据样本划分<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>那么样本划分为什么是合理的呢?原因在于机器学习中的目标函数，也就是训练数据集上的经验风险函数，关于样本是可分的。因为经验风险雨数是所有训练样本对应的损失函数取值的加和，所以如果将训练样本划分成多个数据子集，计算各个子集上的局部梯度值，再将局部梯度加和，仍然可以得到整个经验风险函数的梯度。</p>
<h3 id="_5">数据维度划分<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>按照维度对数据进行划分是另外一种非常自然的数据划分方法。
然而，一般情形下，损失函数关于维度并不是可分的，如果只给定某些维度的数值，并不能计算出损失函数关于这些维度的梯度。例如，在神经网络中，模型在各个维度的梯度是高度耦合的。那么维度划分有适用的机器学习任务吗？答案是肯定的。</p>
<p>第一类是决策树方法。决策树算法中，对维度的处理相对独立可分，将数据按维度划分后，各个工作节点可以独立计算局部维度子集中具有最优信息增益的维度，然后进行交互汇总。所以维度划分方法在分布式决策树算法中应用相对广泛。</p>
<p>第二类是线性模型。对于线性模型而言，模型参数与数据维度是一一对应的，因此数据维度划分常常与模型并行相互结合。</p>
<h2 id="_6">模型并行模式<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p>如果机器学习任务中所涉及的模型规模很大，不能存储到工作节点的本地内存，就需要对模型进行划分，然后各个工作节点负责本地局部模型的参数更新。对具有变量可分性的线性模型和变量相关性很强的非线性模型(比如神经网络)，模型并行的方式有所不同。</p>
<h3 id="_7">线性模型<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>在线性回归、逻辑回归等线性学习任务中，参数往往与数据维度一一对应。如果数据的维度很高，以至于单个工作节点不能存储下所有模型参数和数据维度，可以把模型和数据按维度均等划分，分配到不同的工作节点，在每个工作节点使用坐标下降法进行优化。</p>
<p>对于线性模型而言，目标函数针对各个变量是可分的，也就是说某个维度的参数更新/梯度只依赖于一些与目标函数值有关的全局变量，而不依赖于其他维度的参数取值。于是，为了实现本地参数的更新，我们只需要对这些全局变量进行通信，不需要对其他节点的模型参数进行通信。这是可分性模型进行模型并行的基本原理。</p>
<h3 id="_8">神经网络<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>神经网络由于具有很强的非线性，参数之间的依赖关系比线性模型严重得多，不能进行简单的划分，也无法使用类似线性模型那样的技巧通过一个全局中间变量实现高效的模型并行。但是事物总有两面性，神经网络的层次化结构也为模型并行带来了一定的便利性，比如我们可以横向按层划分、纵向跨层划分或者利用神经网络参数的冗余性进行随机划分。不同划分模式对应的通信内容和通信量是不相同的。</p>
<h4 id="_9">横向按层划分<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>如果神经网络很深，一个自然并且易于实现的模型并行方法是将整个神经网络横向划分为K个部分，每个工作节点承担一层或者几层的计算任务。如果计算所需要的信息本工作节点没有，则向相应的其他工作节点请求相关的信息。模型横向划分的时候，通常我们会结合各层的节点数目，尽可能使得各个工作节点的计算量平衡。</p>
<p><img src="https://blog-img-acking.oss-cn-beijing.aliyuncs.com/img/202308231925992.png" alt="image-20230823192535947" style="zoom:80%;" /></p>
<p>我们考虑一个四层神经网络，包含一个输人层、两个隐含层和一个输出层。系统中总共有三个工作节点并行存储按每层划分后的网络:</p>
<ul>
<li>工作节点1存储输人层和第一个隐含层的相关信息并更新这两层之间连边上的模型参数。存储的信息包括输入层样本各维度的取值、两层之间连边的权重第一个隐含层中各隐含节点的激活函数值和后向传播所需要的误差传播值。</li>
<li>工作节点2存储两个隐含层之间的相关信息并更新隐含层之间连边上的模型参数。存储的信息包括两层之间连边的权重、两个隐含层内隐含节点的激活函数值和误差传播值。</li>
<li>工作节点3存储第二个隐含层和输出层之间的相关信息并更新这两层之间连边上的模型参数。存储的信息包括第二个隐含层中隐含节点的激活函数值和误差传播值、两层之间的连边权重、输出层的softmax 值和误差传播值。</li>
<li>在模型更新的前传和后传过程中，三个工作节点之间需要相互传输以下信息:前传过程中，工作节点2要借用工作节点1更新过的第一个隐含层的激活函数值来更新第二个隐含层的激活函数值。此后，工作节点3 要借用工作节点2更新过的第二个隐含层的激活函数值来更新输出层的 soflmax值</li>
<li>后传过程中，工作节点2要借用工作节点3更新过的第二个隐含层的误差传播值来更新隐含层之间的连边权重和第一个隐含层的误差传播值。此后，工作节点1要借用工作节点2更新过的第一个隐含层的误差传播值来更新输人层和第一个隐含层之间的连边权重。</li>
</ul>
<h4 id="_10">纵向跨层划分<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<p>神经网络除了深度还有宽度(而且通常情况下宽度会大于深度)，因此除了上一小节介绍的横向按层划分外，自然地也可以纵向跨层划分网络，也就是将每一层的隐含节点分配给不同的工作节点。工作节点存储并更新这些纵向子网络。在前传和后传过程中，如果需要子模型以外的激活函数值和误差传播值，向对应的工作节点请求相关信息并进行通信。</p>
<p>我们考虑一个包含两个隐含层的全连接神经网络，输人维度为4，输出维度为1，每个隐含层有四个神经元：</p>
<p><img alt="image-20230823192923914" src="https://blog-img-acking.oss-cn-beijing.aliyuncs.com/img/202308231929978.png" /></p>
<p>工作节点1存储输人层、两个隐含层左半边的两个神经元和输出层，工作节点2存储输人层、两个隐含层右半边的两个神经元和输出层。</p>
<p><strong>除了各个神经元的信息外，工作节点还要存储子网络在整个网络中所关联的连边信息，包含内部连边(实线)和对外连边(虚线)。</strong></p>
<p>前传过程中，工作节点1由输入层前向更新隐含层的左半边两个神经元的激活函数值，然后向工作节点2请求借用其更新过的隐含层的右半边两个神经元的激活函数值在此基础上更新下一层的激活函数值，工作节点2也做对等的操作。</p>
<p>后传过程中，工作节点1将输出层的误差值后向传播得到上隐含层中左半边两个神经元的误差传播值，更新输出层和隐含层之间的模型内和模型外连边，然后向工作节点2请求借用其更新过的上隐含层中右半边两个神经元的误差值，通过后向传播得到下隐含层中左半边两个神经元的误差值，更新上下隐含层之间的内部和对外连边。最后，反向更新输入层和下隐含层之间的连边。工作节点2也做对等的操作。</p>
<h4 id="_11">混合划分<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<p><img src="https://blog-img-acking.oss-cn-beijing.aliyuncs.com/img/202308231932949.png" alt="image-20230823193208886" style="zoom:80%;" /></p>
<h2 id="_12">模型随机并行<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<p>由于纵向和横向划分的通信代价都比较大，最近研究人员又提出了针对大规模神经网络的模型随机划分。
其基本思想是:人们发现神经网络具有一定的冗余性，可以找到一个规模小很多的子网络(称为骨架网络)，其效果与原网络差不多。于是，我们可以首先按照某种准则在原网络中选出骨架网络，作为公用子网络存储于每个工作节点。除骨架网络之外，每个工作节点还会随机选取一些其他节点存储，以探索(exploration)骨架网络之外的信息。骨架网络周期性地依据新的网络重新选取，而用于探索的节点也会每次随机选取图6.4给出了一个随机模型划分的例子。在某次迭代中，橙色隐含层神经元按照某种重要程度指标被选为骨架网络。然后，每个工作节点存储骨架网络，并随机挑选一些骨架外的绿色神经元作为子模型。之后，进人内循环迭代，依据训练样本在前传和后传过程中更新子模型。最后，所有工作节点上更新后的子模型进行聚合操作，从而得到全模型的更新。</p>
<p><img alt="image-20230823193316882" src="https://blog-img-acking.oss-cn-beijing.aliyuncs.com/img/202308231933959.png" /></p>
<p>可以看出，随机模型划分的一个<strong>关键步骤是选取骨架网络</strong>。这个问题在模型压缩和删减领域已经做了很多研究。比如，在文献中，连边的重要性被定义为当前的连边权重的绝对值加上连边梯度值的绝对值。类似地，我们可以将神经网络中神经元的重要性定义为它所连接的所有连边的重要性之和，然后可以利用贪心算法，依次选取当前网络中的重要节点构成骨架网络。</p>
<p>如果神经网络的冗余度比较高，骨架网络的规模会很小。如果当前网络训练还不充分(比如训练开始阶段)，选取的骨架网络还不稳定，随机探索的比例可以比较大。等到训练后期，探索的价值逐渐减小，骨架网络则变得越来越稳定。</p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.top", "search.suggest", "search.highlight", "navigation.expand", "search.share"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>